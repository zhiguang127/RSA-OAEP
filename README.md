# OAEP-RSA 的实现

## 1. 介绍
南邮信息安全综合实验题目二

题目要求:

    RSA算法是应用最为广泛的公钥加密算法之一，但由于基本算法具有的同态性，在实际使用过程中，通常需要对基本的RSA算法进行改进，而RSA-OAEP算法即为实际使用算法之一。本课题致力于对RSA-OAEP算法的模拟实现，使学生深入了解基本RSA算法如何应用到实际的机密性问题解决中，提升编程能力。

## 2. 环境
- JDK:JAVA21 
- GUI:Swing
- IDE:IDEA2024.1

## 3.文件结构
```
RSA-OAEP
├── README.md                   // 说明文档
├── lib                         //依赖库
│   └── flatlaf-2.6.jar         //Swing美化库
└── src 
    ├── Main.java
    ├── com             
    │   └── rsaApp              
    │       ├── Hash            //哈希算法
    │       │   ├── MD4.java    //实现MD4算法    
    │       │   ├── MD5.java    //实现MD5算法
    │       │   └── SHA256.java //实现SHA256算法
    │       ├── OAEP_RSA
    │       │   ├── OAEP.java   //实现OAEP填充，对数据进行预处理
    │       │   ├── RSA.java    //实现RSA加密解密
    │       │   ├── RSAKeyGenertor.java //生成RSA密钥对
    │       │   └── Util.java   //工具类，主要实现字符串格式的处理
    │       ├── Window                  //Swing窗口类包
    │       │   ├── MainWindow.java     //主窗口
    │       │   └── View                //视图包
    │       │       ├── MainView.java   //主视图
    │       │       └── subView         //子视图包
    │       │           ├── HashView.java   //哈希功能视图
    │       │           ├── RsaView.java    //RSA加解密视图
    │       │           └── aboutView.java  //关于页视图
    │       └── shared                  //共享包
    │           ├── ClipboardTUtil.java //剪切板工具类
    │           └── ComponentUtil.java  //Swing组件工具类
    └── resources               //资源包，包含图片资源
        ├── Oaep-.png
        └── rsa.png
```

## 4.架构设计
- 采用了类MVC（Model-View-Controller）的架构风格，将程序分为三个部分
    - Model: 数据模型，负责处理数据
    - View: 视图，负责显示数据
    - Controller: 控制器，负责处理用户的操作

MVC模式的优点是，可以使代码更加清晰，易于维护，同时也可以使代码的重用性更高，因为模型和视图是分开的，所以可以很容易地更改视图而不影响模型，也可以很容易地更改模型而不影响视图。

在本项目中，模型（model）的工作由OAEP-RSA的算法实现来承担，视图（View）和控制器（Controller）部分由Swing的前端控件以及事件处理函数来承担;
当然尽管如此，由于Swing的事件处理函数和前端控件的绑定，使得视图和控制器部分并不是完全分离的，但是在整体上，还是可以认为是类似与MVC模式。

如下图所示：

![1.png](https://s2.loli.net/2025/03/02/Dbn8O9fc1FzXNCp.png)

## 5.程序界面
本程序的界面采用了Swing的GUI库，整体风格采用了FlatLaf的主题，使得界面更加美观。

具体的界面如下：

RSA-OAEP主界面:

![主页面](https://s2.loli.net/2025/03/19/M4Jy8HkGgVQnF2r.png)

haSH功能界面:

![哈希](https://s2.loli.net/2025/03/19/ksfqw9IHg4UprA5.png)


## 6.功能介绍
### 1.RSA密钥生成及存储
 通过使用RSAKeyGenertor类，生成RSA密钥对，用户可以选择将其存储在本地文件中，将会生成两个文件，分别是公钥和私钥，文件名分别为public.key和private.key。
 具体的实现为：使用RSAKeyGenertor类的initKey方法生成密钥对，然后使用RSA类的getPublicKeyStr和getPrivateKeyStr方法获取公钥和私钥的base64编码字符串，然后使用FileUtil类的writeFile方法将公钥和私钥写入本地文件中（如果文件不存在，则创建文件，如果存在，则覆盖）。


### 2.OAEP填充
是将需要加密的明文进行填充，使其长度为RSA算法要求的密钥长度，具体实现为：使用OAEP类的Padding方法进行填充，填充方式为：
1. 将明文进行UTF-8编码
2. 将编码后的明文转换为01序列
3. 在01序列后面加上k1个0，然后加k0位的随机数，这里随机数的长度（k0）是256位，k1由RSA加密长度和k0的值决定，k1 = RSA加密长度（本项目中为1024） - k0 - 1
4. 将处理后的01序列转换为字节数组并返回


### 3.RSA加密解密
是本程序的核心功能，通过使用RSA类，可以实现RSA的加密和解密；
具体流程是：
1. 用户选择加密或解密功能，并输入需要加密或解密的文本，然后点击“加密”或“解密”按钮。
2. 程序会调用RSA类的encrypt或decrypt方法进行加密或解密，并返回结果。
3. 在密文和明文显示框中显示结果，但没有保存为文件的选项，如果用户需要保存，可以手动复制保存。


### 4.MD4、MD5、SHA256哈希算法
这是一个附加的功能，因为在OAEP-RSA算法中，需要使用到哈希算法，而在OEAP填充之后，这几个功能模块就不再被使用，因此秉持着“物尽其用”的原则，本程序也为用户提供了MD4、MD5、SHA256算法



## 7.碎碎念

事实上，整个项目的实现比较赶工，我个人完全实现大概只使用了4天不到（对于数学0基础复习考研的人来说，花费两周去写课设是很奢侈的一件事），尽管达到了比较高的完成度，但依然存在很多问题，比如：
1.对于加密长度上存在着上限，尽管在OAEP的实现内已经考虑到了这一点，并实现了分组填充，但在下游的RSA加解密中，并没有实现分组加解密，而是将整个明文作为一块进行加密，这就会导致一个问题，如果明文长度大于RSA的加密长度，那么就会导致加密失败；
2.尽管项目整体架构类似于MVC架构，但视图和控制器部分并不是完全分离的，这一点受限于Swing的特性，倒也可以接受，但在内部代码上，各个模块的耦合度较高，比如RSA类内就要调用OAEP类和RSAKeyGenertor类的方法，在后期的维护上（如果还有维护的话），会存在一定的问题，可能需要进行重构。

不论如何，这个项目还是让我学到了很多东西，使我对RSA-OAEP算法有了更深入的了解，也让我对Swing的GUI库有了更深入的了解，
也在此将项目分享出来，希望对大家有所帮助。



